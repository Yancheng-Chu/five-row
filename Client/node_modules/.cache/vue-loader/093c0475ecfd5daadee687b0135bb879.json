{"remainingRequest":"H:\\Web\\Client\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!H:\\Web\\Client\\src\\components\\online.vue?vue&type=style&index=0&id=5d461ee3&lang=css","dependencies":[{"path":"H:\\Web\\Client\\src\\components\\online.vue","mtime":1695125746674},{"path":"H:\\Web\\Client\\node_modules\\css-loader\\dist\\cjs.js","mtime":1677376289140},{"path":"H:\\Web\\Client\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1677376291311},{"path":"H:\\Web\\Client\\node_modules\\postcss-loader\\src\\index.js","mtime":1677376289733},{"path":"H:\\Web\\Client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1677376279301},{"path":"H:\\Web\\Client\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1677376291311}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmNhbnZhcyB7CiAgbWFyZ2luLXRvcDogMzBweDsKICBib3gtc2hhZG93OiAtMnB4IC0ycHggMnB4ICNmMGYwZjAsIDVweCA1cHggNXB4ICM5ZDlkOWQ7Cn0KCi50aXRsZSB7CiAgZm9udC1zaXplOiAzMnB4OwogIGZvbnQtd2VpZ2h0OiA4MDA7Cn0K"},{"version":3,"sources":["H:\\Web\\Client\\src\\components\\online.vue"],"names":[],"mappings":";AA+mBA,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACL,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACxD;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACL,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAClB","file":"H:/Web/Client/src/components/online.vue","sourceRoot":"","sourcesContent":["<template>\n  <div>{{ msg }}</div>\n  <div>{{ msg2 }}</div>\n  <div>{{ msg3 }}</div>\n  <div style=\"height: 100vh; width: 100%; text-align: center\">\n    <div class=\"title\">five-to-a-row</div>\n\n    <div style=\"margin-top: 30px\">{{ tip }}</div>\n    <div style=\"position: absolute; display: inline-block\">\n      <button v-on:click=\"restore\">Restore</button>\n      <button :disabled=\"enter\" style=\"margin-left: 408px\" v-on:click=\"chess(1)\">Black</button>\n      <button :disabled=\"enter\" style=\"margin-left: 10px\" v-on:click=\"chess(2)\">White</button>\n    </div>\n\n    <canvas id=\"board\" width=\"600\" height=\"600\"></canvas>\n  </div>\n</template>\n       \n<script>\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\nexport default {\n  name: \"five-to-a-row\",\n  data() {\n    return {\n      enter: true,\n      cookie: '',\n      ctx: null,\n      chessBoard: [],\n      player: true,\n      over: true,\n      lastX: null,\n      lastY: null,\n      wins: [],\n      blackWin: [],\n      whiteWin: [],\n      count: 0,\n      tip: \"\",\n      id: null,\n      msg: \"Please Choose Color\",\n      chosen: false,\n      turn: false,\n      msg2: '',\n      room: null,\n      msg3: '',\n      token: [],\n      total: false,\n      color: ''\n    };\n  },\n  sockets: {\n    newM(data) {\n      this.msg2 = data.msg;\n      this.enter = false\n\n    },\n\n    res() {\n\n      this.enter = false\n      this.restore()\n    },\n    message(data) {\n      this.msg2 = data[1]\n      this.chosen = true\n\n    },\n    updated(data) {\n      if (data) {\n\n        this.token = data\n\n\n\n      }\n\n    },\n    drawU(data) {\n      this.player = data.player;\n      this.chessBoard = data.board;\n      this.blackWin = data.black;\n      this.whiteWin = data.white;\n      this.lastX = data.lastX;\n      this.lastY = data.lastY;\n      this.over = data.over;\n      this.drawChess(data.lastX, data.lastY, data.player);\n      if (data.over) {\n        this.tip = data.results;\n\n      } else {\n        this.tip = data.player ? \"White Turn\" : \"Black Turn\";\n      }\n\n    },\n\n  },\n  mounted() {\n\n\n    this.cookie = JSON.parse(Cookies.get('token'))\n\n\n    this.id = Cookies.get('id')\n\n    this.room = this.cookie.rooms\n\n\n    let container = document.getElementById(\"board\");\n    container.addEventListener(\"click\", this.handleClick);\n    this.ctx = container.getContext(\"2d\");\n    this.drawChessBoard();\n\n    for (let i = 0; i < 15; i++) {\n      this.chessBoard[i] = [];\n      this.wins[i] = [];\n      for (let j = 0; j < 15; j++) {\n        this.chessBoard[i][j] = 0;\n        this.wins[i][j] = [];\n      }\n    }\n    this.horizon();\n    this.vertical();\n    this.slash();\n    this.reverse();\n    this.init();\n\n    if (Cookies.get('room') == this.$route.params.room) {\n\n\n      this.room = this.$route.params.room\n      axios\n        .post(\"http://localhost:1919/chess/room\", {\n          rooms: this.cookie.rooms,\n        })\n        .then((res) => {\n\n          if (res.status == 200) {\n            this.id = res.data._id;\n            if (res.data.board.length != 0) {\n              this.lastX = res.data.lastX;\n              this.lastY = res.data.lastY;\n              this.board = res.data.board;\n              this.chessBoard = res.data.board;\n              this.blackWin = res.data.black;\n              this.whiteWin = res.data.white;\n              this.player = res.data.player;\n              this.over = res.data.over;\n              this.tip = res.data.results;\n              this.token = res.data.token;\n              this.total = res.data.total;\n              this.chosen = res.data.chosen;\n\n              if (this.tip == 'Black Win!' || this.tip == 'White Win!') {\n                this.over = false\n                for (let i = 0; i < 15; i++) {\n                  for (let j = 0; j < 15; j++) {\n                    if (this.board[i][j] == 1) {\n                      this.player = true;\n                      this.drawChess(i, j, this.player);\n                    } else if (this.board[i][j] == 2) {\n                      this.player = false;\n                      this.drawChess(i, j, this.player);\n                    }\n                  }\n                }\n                this.over = true\n              } else {\n\n                for (let i = 0; i < 15; i++) {\n                  for (let j = 0; j < 15; j++) {\n                    if (this.board[i][j] == 1) {\n                      this.player = true;\n                      this.drawChess(i, j, this.player);\n                    } else if (this.board[i][j] == 2) {\n                      this.player = false;\n                      this.drawChess(i, j, this.player);\n                    }\n                  }\n                }\n              }\n\n              this.player = res.data.player;\n            }\n\n            if (res.data.users.length == 2) {\n              this.enter = false\n            }\n            this.total = res.data.total;\n            this.chosen = res.data.chosen;\n\n            this.tip = res.data.results;\n\n            for (let i of res.data.token) {\n\n              if (i.id == this.cookie.id && i.cheese != '') {\n\n                this.total = true\n                this.color = i.cheese\n                this.msg = 'You are ' + this.color\n                if (this.tip == 'Black Turn' && this.color == 'Black') {\n                  this.player = true\n                  this.over = false\n                } else if (this.tip == 'White Turn' && this.color == 'White') {\n                  this.player = false\n                  this.over = false\n                }\n                else {\n                  this.over = true\n                }\n                return\n              } else {\n                this.chosen = false\n                this.total = false\n                this.msg = \"Please Choose Color\"\n              }\n              // if (i.id != this.coookie.id && i.cheese != '') {\n              //   this.msg2 = 'Your opponent chose ' + i.cheese\n              // }\n            }\n\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    }\n  },\n  watch: {\n    msg2(to, from) {\n      if (to != from) {\n        this.enter = false\n      }\n    },\n    over() {\n      // if (this.over) {\n      //   if (!this.player) {\n      //     this.tip = \"White Win!\";\n      //     window.alert(\"White Win!\");\n      //   } else {\n      //     this.tip = \"Black Win!\";\n      //     window.alert(\"Black Win!\");\n      //   }\n      //   // this.tip = !this.player ?  \"White Turn\" : \"Black Turn\";\n      // }\n    },\n    $route(to) {\n      if (to.params.room != this.cookie.rooms) {\n        window.alert(\"You Are Not Allowed\");\n        this.$router.push({\n          name: \"online\",\n          params: { room: this.cookie.rooms },\n        });\n      }\n    },\n  },\n  computed: {},\n  methods: {\n    chess(e) {\n      if (!this.total) {\n        if (!this.chosen) {\n          if (e == 1) {\n            this.chosen = true;\n            this.msg = \"You are Black\";\n            this.over = false;\n            let m = 'Your opponent chose Black'\n\n            this.cookie.cheese = 'Black'\n\n            this.token.push(this.cookie)\n\n            Cookies.set('token', JSON.stringify(this.cookie))\n            this.$socket.emit('sendMessage', this.room, m)\n          } else {\n            this.chosen = true;\n            this.msg = \"You are White\";\n            let m = 'Your opponent chose White'\n\n            this.cookie.cheese = 'White'\n            Cookies.set('token', JSON.stringify(this.cookie))\n            this.token.push(this.cookie)\n            this.$socket.emit('sendMessage', this.room, m)\n          }\n          this.$socket.emit('chosen', this.id, this.chosen)\n        }\n        if (this.chosen) {\n          if (this.msg2 == 'Your opponent chose Black') {\n            if (e == 2) {\n              this.msg = \"You are White\";\n              let m = 'Your opponent chose White'\n\n              this.cookie.cheese = 'White'\n              Cookies.set('token', JSON.stringify(this.cookie))\n              this.token.push(this.cookie)\n              this.$socket.emit('sendMessage', this.room, m)\n            } else {\n              this.msg = ('You can only choose White')\n            }\n          } else if (this.msg2 == 'Your opponent chose White') {\n            if (e == 1) {\n              this.msg = \"You are Black\";\n              let m = 'Your opponent chose Black'\n              this.over = false;\n\n              this.cookie.cheese = 'White'\n              Cookies.set('token', JSON.stringify(this.cookie))\n              this.token.push(this.cookie)\n              this.$socket.emit('sendMessage', this.room, m)\n            } else {\n              this.msg = ('You can only choose Black')\n            }\n          }\n        }\n\n\n        let t = []\n\n        for (let i of this.token) {\n          t.push(i)\n        }\n\n\n        let req = {\n          _id: this.id,\n          board: this.board,\n          player: this.player,\n          black: this.black,\n          white: this.white,\n          lastX: this.lastX,\n          lastY: this.lastY,\n          over: this.over,\n          results: this.tip,\n          token: t\n        };\n\n        this.$socket.emit('updateData', req._id, req.token)\n      } else {\n        this.msg = 'You are already Chosen ' + this.color\n        this.$socket.emit('total', this.id, this.total)\n      }\n    },\n    horizon() {\n      for (var i = 0; i < 15; i++) {\n        for (var j = 0; j < 11; j++) {\n          for (var k = 0; k < 5; k++) {\n            this.wins[i][j + k][this.count] = true;\n          }\n          this.count++;\n        }\n      }\n    },\n    vertical() {\n\n      for (var i = 0; i < 15; i++) {\n        for (var j = 0; j < 11; j++) {\n          for (var k = 0; k < 5; k++) {\n            this.wins[j + k][i][this.count] = true;\n          }\n          this.count++;\n        }\n      }\n    },\n    slash() {\n\n      for (var i = 0; i < 11; i++) {\n        for (var j = 0; j < 11; j++) {\n          for (var k = 0; k < 5; k++) {\n            this.wins[i + k][j + k][this.count] = true;\n          }\n          this.count++;\n        }\n      }\n    },\n    reverse() {\n\n      for (var i = 0; i < 11; i++) {\n        for (var j = 14; j > 3; j--) {\n          for (var k = 0; k < 5; k++) {\n            this.wins[i + k][j - k][this.count] = true;\n          }\n          this.count++;\n        }\n      }\n    },\n    init() {\n      for (var i = 0; i < this.count; i++) {\n        this.blackWin[i] = 0;\n        this.whiteWin[i] = 0;\n      }\n    },\n    drawChessBoard() {\n      for (var i = 0; i < 15; i++) {\n        this.ctx.moveTo(20 + i * 40, 20);\n        this.ctx.lineTo(20 + i * 40, 580);\n        this.ctx.stroke();\n        this.ctx.moveTo(20, 20 + i * 40);\n        this.ctx.lineTo(580, 20 + i * 40);\n        this.ctx.stroke();\n      }\n    },\n    drawChess(x, y, player) {\n      this.ctx.beginPath();\n      this.ctx.arc(20 + x * 40, 20 + y * 40, 15, 0, 2 * Math.PI);\n      this.ctx.closePath();\n      var grd = this.ctx.createRadialGradient(\n        25 + x * 40,\n        15 + y * 40,\n        15,\n        20 + x * 40,\n        20 + y * 40,\n        35\n      );\n      if (!this.over) {\n        if (player) {\n          grd.addColorStop(0, \"#000000\");\n          grd.addColorStop(1, \"#ffffff\");\n        } else {\n          grd.addColorStop(0, \"#ffffff\");\n          grd.addColorStop(1, \"#000000\");\n        }\n        this.player = !this.player;\n        this.ctx.fillStyle = grd;\n        this.ctx.fill();\n      }\n\n    },\n\n    handleClick(event) {\n      if (this.over) {\n        return;\n      } else {\n        var x = Math.floor(event.offsetX / 40);\n        var y = Math.floor(event.offsetY / 40);\n\n        let req = {\n          _id: this.id,\n          board: {},\n          player: true,\n          black: {},\n          white: {},\n          lastX: x,\n          lastY: y,\n          over: false,\n          results: \"\",\n        };\n\n        if (this.chessBoard[x][y] == 0) {\n          this.drawChess(x, y, this.player);\n\n          if (this.player) {\n            this.chessBoard[x][y] = 2;\n            for (let k = 0; k < this.count; k++) {\n              if (this.wins[x][y][k]) {\n                this.whiteWin[k]++;\n\n              }\n            }\n          } else {\n            this.chessBoard[x][y] = 1;\n            for (let k = 0; k < this.count; k++) {\n              if (this.wins[x][y][k]) {\n                this.blackWin[k]++;\n\n              }\n            }\n          }\n\n          for (let k = 0; k < this.count; k++) {\n            if (this.blackWin[k] == 5) {\n              this.over = true;\n              req.over = true;\n              req.results = \"Black Win!\";\n              this.tip = \"Black Win!\";\n              this.$socket.emit(\"uuu\", this.id, req);\n\n            }\n\n            if (this.whiteWin[k] == 5) {\n              this.over = true;\n              req.over = true;\n              req.results = \"White Win!\";\n              this.tip = \"White Win!\";\n              this.$socket.emit(\"uuu\", this.id, req);\n\n            }\n          }\n\n          let draw = {\n            lastX: x,\n            lastY: y,\n            player: !this.player,\n            results: this.player ? \"White Turn\" : \"Black Turn\",\n            board: this.chessBoard,\n            white: this.whiteWin,\n            black: this.blackWin,\n            over: this.over,\n\n          };\n          if (this.over) {\n            draw.results = this.tip;\n          }\n          this.$socket.emit(\"draw\", draw);\n\n          if (this.over) {\n            req.results = this.tip;\n            req.black = this.blackWin;\n            req.white = this.whiteWin;\n            req.board = this.chessBoard;\n            req.player = !this.player;\n            req.over = this.over;\n          } else {\n            req.black = this.blackWin;\n            req.white = this.whiteWin;\n            req.board = this.chessBoard;\n            req.player = !this.player;\n            req.results = !this.player ? \"White Turn\" : \"Black Turn\";\n            req.over = this.over;\n          }\n\n          this.tip = req.results;\n\n\n\n          this.$socket.emit(\"uuu\", req._id, req.board, req.player, req.black, req.white, req.lastX, req.lastY,\n            req.over, req.results);\n\n          this.over = true\n        }\n      }\n    },\n    restore() {\n      if (this.lastX != null || this.lastY != null) {\n        this.ctx.clearRect(0, 0, 600, 600);\n        this.ctx.beginPath();\n        this.ctx.arc(0, 0, 0, 0, 0);\n        this.ctx.fill();\n\n        for (let i = 0; i < 15; i++) {\n          this.chessBoard[i] = [];\n          for (let j = 0; j < 15; j++) {\n            this.chessBoard[i][j] = 0;\n          }\n        }\n        for (let i = 0; i < this.count; i++) {\n          this.blackWin[i] = 0;\n          this.whiteWin[i] = 0;\n        }\n\n        this.drawChessBoard();\n        this.over = true;\n        this.player = true;\n        this.chosen = false;\n        this.total = false;\n\n        this.msg = 'Please Choose Color'\n\n        axios\n          .post(\"http://localhost:1919/chess/upload\", {\n            _id: this.id,\n            over: this.over,\n            player: this.player,\n            board: this.chessBoard,\n            black: this.blackWin,\n            white: this.whiteWin,\n            results: \"Black Turn\",\n            total: this.total,\n            chosen: this.chosen\n          })\n          .then((res) => {\n            if (res.status == 200) {\n              this.tip = \"Black Turn\";\n              this.lastX = null;\n              this.lastY = null;\n              this.cookie.cheese = ''\n              Cookies.set('token', JSON.stringify(this.cookie))\n              let restore = true;\n              this.$socket.emit(\"restores\", restore);\n              this.enter = false\n            }\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }\n\n      this.cookie.cheese = ''\n\n      let c = []\n      c.push(this.cookie)\n      this.token = c\n\n\n      axios\n        .post(\"http://localhost:1919/chess/upload\", {\n          _id: this.id,\n          over: true,\n          player: true,\n          results: \"Black Turn\",\n          total: false,\n          chosen: false,\n          token: this.token\n        })\n        .then((res) => {\n\n          if (res.status == 200) {\n            this.tip = \"Black Turn\";\n            this.msg = \"Please Choose Color\"\n            this.lastX = null;\n            this.lastY = null;\n\n            Cookies.set('token', JSON.stringify(this.cookie))\n\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n\n    },\n  },\n};\n</script>\n       \n<style>\ncanvas {\n  margin-top: 30px;\n  box-shadow: -2px -2px 2px #f0f0f0, 5px 5px 5px #9d9d9d;\n}\n\n.title {\n  font-size: 32px;\n  font-weight: 800;\n}\n</style>"]}]}